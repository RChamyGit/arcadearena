<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
          integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link href='https://fonts.googleapis.com/css?family=Abel' rel='stylesheet' type='text/css'>
    <script src="https://kit.fontawesome.com/4dbf725c93.js" crossorigin="anonymous"></script>

    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
    <title>Hello, world!</title>
</head>
<style>
    body{
    background:rgba(14,16,31,1);
     display:flex;
     flex-direction:column;
     justify-content:center;
       font-family: "Abel", sans-serif;
   min-height:100vh;
   padding-top:90px;
   padding-bottom:90px;

   }

    .page_title{
    position:absolute;
    width:100%;
    color:rgba(255,255,255,.33);

    }
    .page_title p{
     margin-top:-17px;
     letter-spacing:5px;
     color:rgba(255,49,109,0.25);
     font-weight:700}




.perfilBox{
background:rgba(222,222,222,1);
color:rgba(255,255,255,.8);
padding:30px;
margin:15px;
justify-content:center;
border-radius:10px;
box-shadow: 2px 2px 8px rgba(0,0,0,.99);
width:380px;
}


.boxPlay{
margin-bottom:4px;
width:100%;
     text-transform: uppercase;
     background:rgba(14,16,31,.55);
          border-radius:7px;
           box-shadow: 2px 2px 8px rgba(0,0,0,.4);

}



.morto{
border-left:9px solid #C20C1D;
opacity:0.5;
}

.playerName{
color: rgba(255,255,255,0.7);
margin-top:6px;
font-size:12px;
padding:4px;
}

ul{
  list-style-type: none;
         margin:0;
  padding:0;
  }


.input-kills{
width:30px;
background:none;
border:0;
margin-top:5px;
margin-left:-14px;
color:rgba(222,222,222,.5);
font-size:14px;
}

button:active {
    outline: 0;
    border: 0;
}


select:active {
    outline: 0;
    border: 0;
}
button:focus {outline:0;}
input:focus {outline:0;}

input[type="text"], input[type="password"], textarea, select,button {
    outline: none;
}

.colorBox{
background:rgba(14,16,31,.55);
padding-top:2px;
 border-radius:2px;
 box-shadow: 2px 2px 8px rgba(0,0,0,.1);
}

.flex{display:flex;}

.imgXp{
width:60px;
overflow:hidden;
height:25px;

}

.imgXp img{
margin-top:-23px;
margin-left:-33px;
opacity:.5;
}

.kill{
margin-left:-30px;
font-size:12px;
margin-top:10px;
color:rgba(255,255,255,.5)}


.rankingText{
font-size:12px;
margin:0;
padding:0;
color: rgba(14,16,31,.61);
margin-bottom:9px;

}

.score{
font-size:9px;
color:rgba(255,255,255,.5)
}

.scoreNumero{
font-size:12px;
color:rgba(255,255,255,.7)
}

hr{
height:2px;
border-width:0;
color:rgba(108,21,189,0.7);
background: rgba(108,21,189,0.7);
}

.rankContainer{
height:auto;

}

.partidaBox{
padding:3px;
margin-top:10px;
margin-bottom:10px;
width:65px;
   background:rgba(14,16,31,0.6);
display:flex;
     flex-direction:column;
     justify-content:center;
     border-radius:7px;
     box-shadow: 2px 2px 8px rgba(0,0,0,.4);
}

.partidaBox span{
color: rgba(255,255,255,0.4);
font-size:11px;
}


.fillCol{
padding:0;
margin:0;
}

.inputBox input{
width:50px;
background:none;
border:0;
}

.inputBox{
height:35px;

}

.input-inputBox{
    font-size:24px;
    color:rgba(255,255,255,.7);
    margin-top:-5px;
}
.atualizarBox{
margin-left:10px;
width:120px;
height:100%;
display:flex;
     flex-direction:column;
     justify-content:center;
}

.atualizar{
width:100%;
height:100%;
color: rgba(14,16,31,.66);
transition: 1s;
background:none;
pointer-events: none;
border-radius:8px;
border:none;

}

.encerrar{
color: rgba(255,255,255,1);
transition: 1s;
padding:6px;
position:absolute;
margin-left:70px;
margin-top:-70px;
font-size:9px;
opacity:0.77;
background:#ee4540;
border-radius:20px;
}


.encerrar:hover{
color:#fff;

}



.changeBox{
}

.vivo{
opacity:1;
-webkit-transition:  1s;
  -moz-transition:  1s;
  -ms-transition:  1s;
  -o-transition:  1s;
  transition:  1s;
  transition-timing-function: ease-in-out;
width:auto;
padding:2px;
margin-top:2px;
background:none;
border:none;
}
.btn{
border:none;
}
.changeStatus{
width:auto;
padding:2px;
margin-left:-40px;
background:none;
border:none;
margin-right:2px;
margin-top:2px;
opacity:0.5;
-webkit-transition:  1s;
  -moz-transition:  1s;
  -ms-transition:  1s;
  -o-transition:  1s;
  transition:  1s;
   transition-timing-function: ease-in-out;
}
.headerTitle{
width:100%;
padding:5px;
border-bottom:3px solid rgba(14,16,31,.35);;
margin-bottom:18px;
}

.headerTitle2{
width:100%;
padding:5px;
border-bottom:3px solid rgba(14,16,31,.22);;
margin-bottom:18px;
}

.scoreBox{
width:100%;
padding:2px;
border:2px solid rgba(108,21,189,0.35);
border-radius:7px;
margin-bottom:6px;
}

.scoreBox h6{
color: rgba(255,255,255,0.35);
margin-top:15px;
margin-left:3x;
}

.scoreBox p{
background: rgba(0,0,0,.4);
color:rgba(255,255,255,0.6);
padding:4px;
margin:0;
margin:2px;
font-size:20px;
}

.headerTitle h6{
color:rgba(14,16,31,.35);
position:absolute;
font-size:13px;
background:rgba(222,222,222,1);
padding:5px;
margin-top:40px;
right:70px;
}



.headerTitle2 h5{
color:rgba(14,16,31,.35);
position:absolute;
font-size:13px;
background:rgba(222,222,222,1);
padding:5px;
right:40px;
margin-top:-6px;
}

.headerTitle2 h2{
color:rgba(14,16,31,.55);
margin-top:8px;
font-size:30px;

}





.headerTitle h2{
color:rgba(14,16,31,.55);
margin-top:8px;
font-size:25px;
}

.disabled{
opacity:0.3;
pointer-events: none;
}

.enable{
transform: scale(1.2);
}


.Spinner{
color:rgba(14,16,31,.7);
width: 3rem; height: 3rem;
display:none;
}

ul{
margin-bottom:15px;
}


.channelBox{

padding-right:10px;

}

.endBox{
position:absolute;
right:100px;
margin-left:45px;
z-index:999999999;
background:none;
border:2px solid rgba(255,255,255,.45);
padding:10px;
border-radius:50%;
transform:scale(0.75);
background:rgba(14,16,31,1);
}

.viewGrup{
position:fixed;
bottom:10px;
right:15px;

}

.linkView{
position:absolute;
right:0;
margin-top:-35px;

z-index:999999999;
}

.channelBox a{
 display:flex;
     flex-direction:column;
     justify-content:center;
}


.transmissao{
padding:9px;
opacity:.6;}

.vd {
margin-left:17px;
}

.check{
background:red;}


.toggle-group {
background: #dc3545;
opacity:0.7;


}

.btn-primary {
    color: #fff;
    background-color: #28a745;
    border-color: #28a745;

}

.btn-primary:hover {
    color: #fff;
    background-color: #28a745;
    border-color: #28a745;
}

#toggle-two{
margin-left:-10px;}


.spintext{
position:absolute;
margin-top:44px;
color:rgba(14,16,31,1);
font-weight:500;
display:none;

}

.on, .off{
cursor:pointer;
opacity:0.7;
}

.on{
background:#ee4540;
border:2px solid rgba(255,255,255,1);
padding:10px;
border-radius:50%;
opacity:0.77;
}


.textON{
position:absolute;
margin-top:80px;
margin-left:7px;
background:#ee4540;
color:rgba(255,255,255,1);
padding:4px;
}


.off{
background:none;
border:2px solid rgba(255,255,255,1);
padding:10px;
border-radius:50%;
opacity:0.45;
}
.off img{
filter: invert(1);
}

.next{
filter: invert(1);
}

.breakRound{
filter: invert(1);
}

.textOFF{
position:absolute;
margin-top:80px;
margin-left:7px;
background:rgba(14,16,31,1);
color:rgba(255,255,255,1);
padding:4px;
}
.textENCERRAR{
position:absolute;
background:rgba(14,16,31,1);
color:rgba(255,255,255,.45);
margin-left:-15px;
}

.playerBoxInt{
margin-bottom:2px;
}

ul {
    display: block;
    list-style-type: none;
    margin-block-start: 0em;
    margin-block-end: 0em;
    margin-inline-start: 0px;
    margin-inline-end: 0px;
    padding-inline-start: 0px;
}


.game{
margin-top:-7px;}




.breakRound{
height: 35px;
opacity:0.8;
cursor:pointer;
opacity:0.45;
}

.navbar{
     background:rgba(14,16,31,1);

}

.navbar a{
color:rgba(255,255,255,.7);
margin-left:15px;
}

.line{
position:fixed;
border:1px solid rgba(255,255,255,1);
height:450px;
opacity:0.45;
left:75px;
top:180px;
}


.topStagecontainer{



}
.round-one .matchup{
width:400px;
margin:20px auto;
background:#e8e8e8;
padding:14px 18px 14px 18px;


}

.current li {
  opacity: 1;
  font-size:12px;
}
.current li.team {
  background-color: #fff;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
  opacity: 1;
}
.round-one .team{
border-radius:5px;
height:40px;
padding:8px;

}
.team {
  padding: 0 5px;
  margin: 3px 0;
  height: 25px;
  line-height: 25px;
  white-space: nowrap;
  overflow: hidden;
  position: relative;
  color:rgba(0,0,0,1);
  width:100%;
}

.team h6{

  color:rgba(0,0,0,1);
  font-size:12px;
}

.scoreA {
  font-size: 12px;
  text-transform: uppercase;
  float: right;
color: #000;
  font-weight: bold;
  font-family: "Roboto Condensed", sans-serif;

  width:90px;
  height:30px;
  margin-top:-3px;
  padding:3px;
}
.scoreAx {
  font-size: 11px;
  text-transform: uppercase;
  float: right;
  color: #000;
  font-weight: bold;
  font-family: "Roboto Condensed", sans-serif;
  right: 17px;
  width:45px;
}

.score {
  font-size: 11px;
  text-transform: uppercase;
  color: #000;
  font-weight: bold;
  font-family: "Roboto Condensed", sans-serif;
  width:30px;
  margin-top:-10px;
  position: absolute;
  padding:7px;
  margin-left:-10px;

}

#collapseExample{

}


.topLine2{
font-size:10px;
color:#c72c41;
width:100%:}
.flame2{
width:90px;
}
.flame3{
width:180px;
}

.subflame2{
  width:45px;
}


</style>
<body>
<nav class="navbar fixed-top">
    <a class="navbar-brand" href="/dashboard">
        <!--    <img src="/docs/4.5/assets/brand/bootstrap-solid.svg" width="30" height="30" class="d-inline-block align-top" alt="" loading="lazy">-->
        ARCADE ARENA
    </a>
     <div class="channelBox text-left" id="channelBox">
        <img src="/static/assets/viver.svg" height="40">
    </div>
    <a class="endBox text-left"  data-id="{{idcampeonato}}" data-status="{{status}}">
    <img class="breakRound" src="/static/assets/bandeira-de-corrida.svg">
    <p class="textENCERRAR">ENCERRAR</p>
</a>


<div class="viewGrup">
    <p>
        <a class="linkView" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false"
           aria-controls="collapseExample">
            <img style="filter:invert(1); opacity:.5;" src="/static/assets/visao.svg" height="45">
        </a>
    </p>
    <div class="collapse" id="collapseExample">
        <div class="container topStagecontainer text-center" id="faseGrupos">

            <div class="round round-one current">
                <ul id="view" class="matchup">
                    <li class="topLine2 flex">
                        <div class="flame3 text-center">SQUADS</div>
                        <div class="subflame2">JOGO 1</div>
                        <div class="subflame2">JOGO 2</div>
                        <div class="flame2">TOTAL</div>
                    </li>

                </ul>

            </div>
        </div>
    </div>
</div>
</nav>




<div class="container-fluid page_title text-center">
    <h1>ARCADE ARENA</h1>
    <p>dashboard</p>
</div>


<div class="container-fluid pd40">
    <div class="row justify-content-md-center" id="mylist">

    </div>
</div>


<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
        integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
        crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"
        integrity="sha256-yr4fRk/GU1ehYJPAs8P4JlTgu0Hdsp4ZKrx8bDEDC3I=" crossorigin="anonymous"></script>


</body>
<script>

var socket = io.connect('http://' + document.domain + ':' + location.port) ;




var playerSelect = (function() {
  // =============================
  // Private methods and propeties
  // =============================
  equipe = [];

  // Constructor
  function Item(id,idplayer, idsquad, name,kills_1,kills_2,sKill,sWins,sTop5,sDeaths,sKD,sLevel,jogo_ativo,status) {
      this.id = id;
    this.idplayer = idplayer;
    this.idsquad = idsquad;

    this.name = name;
    this.kills_1 = kills_1;
    this.kills_2 = kills_2;
    this.sKill = sKill;
    this.sWins = sWins;
    this.sTop5 = sTop5;
    this.sDeaths = sDeaths;
    this.sKD = sKD;
    this.sLevel = sLevel;
    this.jogo_ativo = jogo_ativo;
    this.status = status;
  }


  // Save Equipe
  function saveEquipe() {
    sessionStorage.setItem('playerSelect', JSON.stringify(equipe));
  }






    // Load Equipe
  function loadEquipe() {
    equipe = JSON.parse(sessionStorage.getItem('playerSelect'));
  }
  if (sessionStorage.getItem("playerSelect") != null) {
    loadEquipe();
  }




  // =============================
  // Public methods and propeties
  // =============================
  var objEquipe = {};

  // Add to cart
  objEquipe.addItemToEquipe = function(id,idplayer, idsquad, name,kills_1,kills_2,sKill,sWins,sTop5,sDeaths,sKD,sLevel,jogo_ativo,status) {
      for(var item in equipe) {
        if(equipe[item].id === id && parseInt(equipe[item].status) === parseInt(status)) {
        return;
        }

      }
      var item = new Item(id,idplayer, idsquad, name,kills_1,kills_2,sKill,sWins,sTop5,sDeaths,sKD,sLevel,jogo_ativo,status);
      equipe.push(item);

      saveEquipe()
    }

    // Clear cart
  objEquipe.clearEquipe = function() {
    equipe = [];
    saveEquipe()
  }

    // Update items from cart
  objEquipe.updateItemFromCart = function(id,item,value) {
    for(var i in equipe) {
      if(equipe[i].id === id && parseInt(equipe[i].status) === parseInt({{status}}) ) {
         sessionStorage.setItem(equipe[i].item, value);
        break;
      }
    }
    saveEquipe();
  }


   // Set count from KILL
  objEquipe.setCountForItemKILL = function(id, kills, jogo_ativo) {
    for(let time of equipe) {
      if (time.id === id &&  parseInt(time.status) === parseInt({{status}})) {

            switch (jogo_ativo) {
                  case 'R2J1':
                   time.kills_1 = kills;
                   item = 'kills_1'
                 break;

                 case 'R2J2':
                  time.kills_2 = kills;
                   item = 'kills_2'
                break;



                 case 'R3J1':
                   time.kills_1 = kills;
                   item = 'kills_1'
                 break;


                case 'R3J2':
                   time.kills_2 = kills;
                   item = 'kills_2'
                 break;


                 case 'R4J1':
                  time.kills_1 = kills;
                   item = 'kills_1'
                break;

                case 'R4J2':
                   time.kills_2 = kills;
                   item = 'kills_2'
                 break;


                 case 'R5J1':
                  time.kills_1 = kills;
                   item = 'kills_1'
                break;

                case 'R5J2':
                   time.kills_2 = kills;
                   item = 'kills_2'
                 break;




                }


        playerSelect.updateItemFromCart(time.id,item,kills);
        var killsSquad = playerSelect.totalKills(time.idsquad,jogo_ativo);

        partidaBracket.updateItemFromCart(parseInt(time.idsquad),item,killsSquad);
        partidaBracket.killsScoreCount(time.idsquad,killsSquad,jogo_ativo);
        partidaBracket.totalCart(time.idsquad);
        break;

      }
    }
  };

    // SetNextStage
  objEquipe.SetNextStagePlayer = function(idsquad,jogo_ativo) {
    for(let player of equipe) {
      if (parseInt(player.idsquad) == parseInt(idsquad)  &&  parseInt(player.status) === parseInt({{status}}) ) {
      console.log(player)
          switch (jogo_ativo) {
                  case 'R2J1':
                    player.jogo_ativo = 'R2J2';
                 break;
                  case 'R2J2':
                  player.jogo_ativo = 'R2J1';
                break;
                case 'R3J1':
                    player.jogo_ativo = 'R3J2';
                 break;
                  case 'R3J2':
                  player.jogo_ativo = 'R3J1';
                break;

                case 'R4J1':
                    player.jogo_ativo = 'R4J2';
                 break;
                  case 'R4J2':
                  player.jogo_ativo = 'R4J1';
                break;
                case 'R5J1':
                    player.jogo_ativo = 'R5J2';
                 break;
                  case 'R5J2':
                  player.jogo_ativo = 'R5J1';
                break;
                }
      }
    }
   saveEquipe();
  }

  // Count cart
  objEquipe.totalKills = function(idsquad,jogo_ativo) {
    var totalKills = 0;
    for(let time of equipe) {
        if (parseInt(time.idsquad) === parseInt(idsquad) &&  parseInt(time.status) === parseInt({{status}}) ) {
            switch (jogo_ativo) {
                  case 'R2J1':
                    totalKills += time.kills_1;
                 break;

                 case 'R3J1':
                    totalKills += time.kills_1;
                 break;

                  case 'R2J2':
                  totalKills += time.kills_2;
                break;

                case 'R3J2':
                    totalKills += time.kills_1;
                 break;

                  case 'R4J1':
                  totalKills += time.kills_1;
                break;

                case 'R4J2':
                    totalKills += time.kills_2;
                 break;

                  case 'R5J1':
                  totalKills += time.kills_1;
                break;

                case 'R5J2':
                    totalKills += time.kills_2;
                 break;

                }
      }
    }

    return totalKills;
  }



  // List cart
  objEquipe.listEquipe = function(idsquad) {
  var cartCopy = [];
  for(id in idsquad) {
     for(i in equipe) {
            if (parseInt(equipe[i].idsquad) === parseInt(idsquad[id]) && parseInt(equipe[i].status) === parseInt({{status}}) ) {
              item = equipe[i];
              itemCopy = {};
                  for(p in item) {
                    itemCopy[p] = item[p];
                  }
              cartCopy.push(itemCopy)
            }
    }
}

    return cartCopy;
  }



  // List cart
  objEquipe.listPlayer = function(id) {
  var cartCopy = [];
     for(i in equipe) {
            if (parseInt(equipe[i].id) === parseInt(id)) {
              item = equipe[i];
              itemCopy = {};
                  for(p in item) {
                    itemCopy[p] = item[p];
                  }
              cartCopy.push(itemCopy)
            }
    }

    return cartCopy;
  }



  // cart : Array
  // Item : Object/Class
  // addItemToCart : Function
  // removeItemFromCart : Function
  // removeItemFromCartAll : Function
  // clearCart : Function
  // countCart : Function
  // totalCart : Function
  // listCart : Function
  // saveCart : Function
  // loadCart : Function
  return objEquipe;
})();








var partidaBracket = (function() {
  // =============================
  // Private methods and propeties
  // =============================
  partida = [];

  // Constructor
  function Item(id,idsquad, name,score_1,score_2, score_total,kills_1,kills_2,rank_1,rank_2,stream,jogo_ativo,grupo,status,posicao_atual) {
    this.id = id;
    this.idsquad = idsquad;
    this.name = name;
    this.kills_1 = kills_1;
    this.kills_2 = kills_2;
    this.rank_1 = rank_1;
    this.rank_2 = rank_2;
    this.score_1 =score_1;
    this.score_2 =score_2;
    this.score_total = score_total;
    this.jogo_ativo = jogo_ativo;
    this.stream = stream;
    this.grupo = grupo;
    this.status = status;
    this.posicao_atual = posicao_atual;

  }


  // Save cart
  function saveCart() {
    sessionStorage.setItem('partidaBracket', JSON.stringify(partida));
  }

    // Load cart
  function loadCart() {
    partida = JSON.parse(sessionStorage.getItem('partidaBracket'));
  }
  if (sessionStorage.getItem("partidaBracket") != null) {
    loadCart();
  }


  // =============================
  // Public methods and propeties
  // =============================
  var obj = {};

  // Add to cart
  obj.addItemToCart = function(id,idsquad, name,score_1,score_2, score_total,kills_1,kills_2,rank_1,rank_2,stream,jogo_ativo,grupo,status,posicao_atual) {
      for(var item in partida) {
        if(partida[item].id === id && partida[item].status === status) {

          return;
        }
      }
      var item = new Item(id,idsquad, name,score_1,score_2, score_total,kills_1,kills_2,rank_1,rank_2,stream,jogo_ativo,grupo,status,posicao_atual);
      partida.push(item);

      saveCart();
    }

    // Clear cart
  obj.clearCart = function() {
    partida = [];
    saveCart();
  }






  // Update items from cart
  obj.updateItemFromCart = function(id,item,value) {
    for(var i in partida) {
      if(partida[i].idsquad === parseInt(id) && parseInt(equipe[i].status) === parseInt({{status}})) {
         for (j in partida[i]){
             if (j == item){
             partida[i][j] = value
                }
            };
        break;
      }
    }
   saveCart();
  }




  // SetNextStage
  obj.SetNextStage = function(idsquad,jogo_ativo) {
    for(let time of partida) {
      if (parseInt(time.idsquad) === parseInt(idsquad) && parseInt(time.status) === parseInt({{status}})) {

               switch (jogo_ativo) {
                  case 'R2J1':
                    time.jogo_ativo = 'R2J2';
                 break;
                  case 'R2J2':
                  time.jogo_ativo = 'R2J1';
                break;
                case 'R3J1':
                    time.jogo_ativo = 'R3J2';
                 break;
                  case 'R3J2':
                  time.jogo_ativo = 'R3J1';
                break;
                case 'R4J1':
                    time.jogo_ativo = 'R4J2';
                 break;
                  case 'R4J2':
                  time.jogo_ativo = 'R4J1';
                break;
                case 'R5J1':
                    time.jogo_ativo = 'R5J2';
                 break;
                  case 'R5J2':
                  time.jogo_ativo = 'R5J1';
                break;
                }
      }
    }
   saveCart();
  }

  // Set count from rank
  obj.setCountForItemRank = function(idsquad, rank,jogo_ativo) {
    for(let time of partida) {
      if (parseInt(time.idsquad) === parseInt(idsquad) &&  parseInt(time.status) === parseInt({{status}}) ) {
       var x = partidaBracket.setScoreRank(parseInt(rank));

         switch (jogo_ativo) {
                  case 'rank_1':
                   var killsSquad = playerSelect.totalKills(time.idsquad,time.jogo_ativo);
                    time.score_1 = (killsSquad * parseInt({{regras.0.6}})) + x;
                    time.rank_1 = rank;
                 break;
                  case 'rank_2':
                   var killsSquad = playerSelect.totalKills(time.idsquad,time.jogo_ativo);
                    time.score_2 = (killsSquad * parseInt({{regras.0.6}})) + x;
                    time.rank_2 = rank;
                break;
                }



      }
    }
    saveCart();
  };


  // Set SCORE from rank
  obj.setScoreRank = function(rank) {
    var x = [] ;
    if(rank == 0 ){
    x.push(0) ;
    }
    if(rank == 1 ){
    x.push({{regras.0.1}}) ;
    }
    if(rank == 2 ){
    x.push({{regras.0.2}}) ;
    }
    if(rank == 3 ){
    x.push({{regras.0.3}}) ;
    }
    if(3 < rank && rank < 11 ){
    x.push({{regras.0.4}}) ;
    }
    if(10 < rank && rank < 16 ){
    x.push({{regras.0.4}}) ;
    }
    if(rank > 15 ){
    x.push(0) ;
    }
    return x[0];
  };








  obj.killsScoreCount = function(idsquad,killsSquad,jogo_ativo) {
    var totalCount = killsSquad * parseInt({{regras.0.6}});
    for(let time of partida) {
        if (parseInt(time.idsquad) === parseInt(idsquad) &&  parseInt(time.status) === parseInt({{status}}) ) {
        switch (jogo_ativo) {
                  case 'R2J1' :
                    time.score_1 = totalCount + partidaBracket.setScoreRank(time.rank_1);
                 break;
                 case 'R3J1' :
                    time.score_1 = totalCount + partidaBracket.setScoreRank(time.rank_1);
                 break;
                  case 'R2J2':
                   time.score_2 = totalCount + partidaBracket.setScoreRank(time.rank_2);
                break;
                case 'R3J2':
                   time.score_2 = totalCount + partidaBracket.setScoreRank(time.rank_2);
                break;

                  break;
                  case 'R4J1':
                   time.score_1 = totalCount + partidaBracket.setScoreRank(time.rank_1);
                break;
                case 'R4J2':
                   time.score_2 = totalCount + partidaBracket.setScoreRank(time.rank_2);
                break;

                  break;
                  case 'R5J1':
                   time.score_1 = totalCount + partidaBracket.setScoreRank(time.rank_1);
                break;
                case 'R3J2':
                   time.score_2 = totalCount + partidaBracket.setScoreRank(time.rank_2);
                break;
                }



      }
    }
   saveCart();

  }






  // Total cart
  obj.totalCart = function(idsquad) {
    var totalCart = 0;
        for(let time of partida) {
            if (parseInt(time.idsquad) === parseInt(idsquad) &&  parseInt(time.status) === parseInt({{status}}) ) {
                time.score_total = parseInt(time.score_1) + parseInt(time.score_2);
           }
        }
        saveCart();
    return totalCart;
  }





  // List cart
  obj.listCart = function(idsquad) {

    var cartCopy = [];
for(id in idsquad) {
 for(i in partida) {
        if (parseInt(partida[i].idsquad) === parseInt(idsquad[id]) && parseInt(partida[i].status) === parseInt({{status}})) {
          item = partida[i];
          itemCopy = {};
              for(p in item) {
                itemCopy[p] = item[p];
              }
          cartCopy.push(itemCopy)
        }
    }
}
    return cartCopy;
  }




    // List cart
  obj.listCartALL = function() {
    var cartCopy = [];
    for(i in partida) {
          item = partida[i];
          itemCopy = {};
              for(p in item) {
                itemCopy[p] = item[p];
              }
          cartCopy.push(itemCopy)
        }
    return cartCopy;
  }

  // cart : Array
  // Item : Object/Class
  // addItemToCart : Function
  // removeItemFromCart : Function
  // removeItemFromCartAll : Function
  // clearCart : Function
  // countCart : Function
  // totalCart : Function
  // listCart : Function
  // saveCart : Function
  // loadCart : Function
  return obj;
})();



function htmlToElements(html) {
    var template = document.createElement('template');
    template.innerHTML = html;
    return template.content.childNodes;
}

$(document).ready(function () {

//partidaBracket.clearCart();
//playerSelect.clearEquipe();

var checkStage= ({{ status}});
var ativo = createTeam()
createPlayers(ativo[0])
displayCart(ativo[1]);
var check = partidaBracket.listCartALL();

//console.log(check)




})





function createTeam(){
var myGeocode = [{{ round|tojson }}];

var ativo = [];
var listaSquad = [];


myGeocode.forEach(function(x) {
                x.forEach(function(p) {
                p.forEach(function(e) {
                    var id = e[0];
                    var idsquad = e[3];
                    var name = e[4];
                    var score_1 = 0;
                    var score_2 = 0;

                    var kills_1 = 0;
                    var kills_2 = 0;

                    var rank_1 = 0;
                    var rank_2 = 0;
                    var score_total = 0;
                    var jogo_ativo = e[26];
                    var stream = e[27];
                    var grupo = e[22];
                    var status = e[9];
                    ativo.push(status);
                    listaSquad.push(idsquad);



                    if (parseInt(status) === 1){
                    var posicao_atual = e[28];
                    }

                    if (parseInt(status) === 2){
                    var posicao_atual = e[29];
                    }

                    if (parseInt(status) === 3){
                    var posicao_atual = e[30];
                    }

                    if (parseInt(status) === 4){
                    var posicao_atual = e[31];
                    }


                    partidaBracket.addItemToCart(id,idsquad, name,score_1,score_2, score_total,kills_1,kills_2,rank_1,rank_2,stream,jogo_ativo,grupo,status,posicao_atual);
                })
})
            })


            return [ativo,listaSquad]

}

function createPlayers(ativo){
var jogadores = {{ players|tojson }};

    jogadores.forEach(function(player) {

                  player.forEach(function(i) {

                  var id = i[0];
                  var idplayer = i[0];
                  var idsquad = i[10];
                  var name = i[2];
                  var kills_1 = 0;
                  var kills_2 = 0;
                  var sKill = i[3];
                  var sWins = i[4];
                  var sTop5 = i[5];
                  var sDeaths = i[6];
                  var sKD = i[7];
                  var sLevel = i[11];
                  var status = parseInt({{status}});
                  var jogo_ativo = '';


                  switch (status) {
                  case 4:
                    jogo_ativo = 'R4J1';
                 break;
                  case 3:
                    jogo_ativo = 'R4J1';
                 break;
                  case 2:
                    jogo_ativo = 'R3J1';
                 break;
                 case 1:
                    jogo_ativo = 'R2J1';
                 break;

                }

                   playerSelect.addItemToEquipe(id,idplayer, idsquad, name,kills_1,kills_2,sKill,sWins,sTop5,sDeaths,sKD,sLevel,jogo_ativo,status);
                    });

    });

};





function displayCart(idsquad) {
//playerSelect.clearEquipe();
//partidaBracket.clearCart();

document.getElementById('view').innerHTML = '';
  var cartArray = partidaBracket.listCart(idsquad);
  var output = "";
  var HTML = "";

         for( let squad of cartArray){

             if(parseInt(squad.status) === parseInt(1) ){
             switch (squad.jogo_ativo) {
                  case 'R2J1':
                    score = squad.score_1;
                    jogo_ativo = squad.jogo_ativo
                    status_rank_1 = 'enable';
                    status_rank_2 = 'disabled'
                    break;
                  case 'R2J2':
                    score = squad.score_2;
                    jogo_ativo = squad.jogo_ativo
                    status_rank_2 = 'enable';
                     status_rank_1 = 'disabled'
                    break;
                }

             }
             if(parseInt(squad.status) === parseInt(2) ){

             switch (squad.jogo_ativo) {

                  case  'R3J1':
                    score = squad.score_1;
                    jogo_ativo = squad.jogo_ativo
                    status_rank_1 = 'enable';
                    status_rank_2 = 'disabled'
                    break;
                  case 'R3J2':
                    score = squad.score_2;
                    jogo_ativo = squad.jogo_ativo
                    status_rank_2 = 'enable';
                     status_rank_1 = 'disabled'
                    break;
                }
             }
               if(parseInt(squad.status) === parseInt(3) ){

             switch (squad.jogo_ativo) {
                  case  'R4J1':
                    score = squad.score_1;
                    jogo_ativo = squad.jogo_ativo
                    status_rank_1 = 'enable';
                    status_rank_2 = 'disabled'
                    break;
                  case 'R4J2':
                    score = squad.score_2;
                    jogo_ativo = squad.jogo_ativo
                    status_rank_2 = 'enable';
                     status_rank_1 = 'disabled'
                    break;
                }
             }

             if(parseInt(squad.status) === parseInt(4) ){

             switch (squad.jogo_ativo) {
                  case  'R5J1':
                    score = squad.score_1;
                    jogo_ativo = squad.jogo_ativo
                    status_rank_1 = 'enable';
                    status_rank_2 = 'disabled'
                    break;
                  case 'R5J2':
                    score = squad.score_2;
                    jogo_ativo = squad.jogo_ativo
                    status_rank_2 = 'enable';
                     status_rank_1 = 'disabled'
                    break;
                }
             }



             var soma = parseInt(squad.score_1) + parseInt(squad.score_2) ;
         var li = document.createElement("li");
            li.setAttribute('class', 'team team-top');
             li.setAttribute('data-percentage', soma);
             li.setAttribute('data-idsquad', squad.idsquad);
             li.setAttribute('data-idpartidas_online', squad.id);
              li.setAttribute('data-posicao', squad.posicao_atual);


            var textnode = document.createTextNode(squad.name);
            li.appendChild(textnode);
             var span = document.createElement("span");
             span.setAttribute('class', 'scoreA');
             var textnode2 = document.createTextNode(soma);
             span.appendChild(textnode2);
             li.appendChild(span);

             var span2 = document.createElement("span");
             span2.setAttribute('class', 'scoreAx');
             var textnode12 = document.createTextNode(parseInt(squad.score_2));
             span2.appendChild(textnode12);
             li.appendChild(span2);
            var span1 = document.createElement("span");
             span1.setAttribute('class', 'scoreAx');
             var textnode11 = document.createTextNode(parseInt(squad.score_1));
             span1.appendChild(textnode11);
             li.appendChild(span1);
             document.getElementById('view').appendChild(li);
output +=
            '<div class="col-md-auto">' +
                '<div class="card perfilBox">'+
                    ' <div class="container-fluid headerTitle">'+
                    '<h6>NOME DA EQUIPE || SQUAD</h6><h2>'+ squad.name + '</h2>'+
                        '<div class="container-fluid text-center" >'+
                            '<button  class="btn encerrar" name="'+jogo_ativo+'" data="'+squad.idsquad+'">'+
                                ' AVANÃ‡AR PARTIDA <img class="next" src="/static/assets/avanco-rapido.svg" height="18">'+
                             '</button>'+
                        '</div>'+
                    '</div>'+
                    '<div class="playerBoxInt">'+
                        '<ul id='+squad.idsquad+ '>'+
                        '</ul>'+
                    '</div>'+
                    ' <div class="container-fluid headerTitle2">'+
                        '<div class="row">'+
                            '<div class="col-6 text-right">'+
                                '<h2 id="score_partida'+squad.id+'" class="text-center">'+
                                    score+
                                '</h2>'+
                                '<h5>SCORE PARTIDA</h5>'+
                            '</div>'+
                            '<div class="col-6 text-right">'+
                                '<h2 id="score_total'+squad.id+'" class="text-center">'+
                                squad.score_total+
                                '</h2>'+
                                '<h5>SCORE TOTAL</h5>'+
                            '</div>'+
                        '</div>'+
                    '</div>'+
                    '<div class="container rankContainer text-center">'+
                        '<div class="row">'+
                            '<div class="col-8 fillCol">'+
                                '<div class="row">'+
                                    '<div class="col-4">'+
                                        '<div class="partidaBox ' + status_rank_1 + ' ">'+
                                            '<span>RANK</span><span class="game">JOGO 1</span>'+
                                            '<div class="inputBox ">'+
                                            '<input type="text" name="'+squad.idsquad+'" data="rank_1" class="input-inputBox text-center"value="'+squad.rank_1+'">'+
                                            '</div>'+
                                        '</div>'+
                                    '</div>'+
                                    '<div class="col-4">'+
                                        '<div class="partidaBox ' + status_rank_2 + ' ">'+
                                            '<span>RANK</span><span class="game">JOGO 2</span>'+
                                            '<div class="inputBox ">'+
                                            '<input type="text" name="'+squad.idsquad+'" data="rank_2" class="input-inputBox text-center "value="'+squad.rank_2+'">'+
                                            '</div>'+
                                        '</div>'+
                                    '</div>'+

                                '</div>'+
                            '</div>'+
                            '<div class="col-4 fillCol">'+
                                '<div class="container-fluid atualizarBox">'+
                                    '<button id="'+squad.id+'hide"class=" atualizar">'+
                                    '<img class="img" src="/static/assets/videogame.svg" height="60">'+
                                    '</button>'+
                                    '<div class="d-flex justify-content-center">'+
                                        '<div id="'+squad.id+'hideSpinner" class="spinner-grow Spinner"role="status">'+
                                            '<span class="sr-only">Loading...</span>'+
                                        '</div>'+
                                    '</div>'+
                                '</div>'+
                            '</div>'+
                        '</div>'+
                    '</div>'+
                '</div>'+
            '</div>';

         }
         document.getElementById('mylist').innerHTML = output;

         var PlayerArray = playerSelect.listEquipe(idsquad);


         for (let player of PlayerArray){

                switch (player.jogo_ativo) {
                  case 'R2J1':
                   kill = player.kills_1
                 break;
                 case 'R3J1':
                   kill = player.kills_1
                 break;
                  case 'R2J2':
                  kill = player.kills_2
                break;
                case 'R3J2':
                  kill = player.kills_2
                break;


                  case 'R4J1':
                  kill = player.kills_1
                break;
                case 'R4J2':
                  kill = player.kills_2
                break;

                case 'R5J1':
                  kill = player.kills_1
                break;
                case 'R5J2':
                  kill = player.kills_2
                break;


                }


                  document.getElementById(player.idsquad).innerHTML += '<li>'+
                            '<div class="boxPlay" id="'+player.id + 'status">'+
                                '<div class="row justify-content-md-center">'+
                                    '<div class="col-6">'+
                                        '<div class="flex">'+
                                            '<div class="changeBox">'+
                                                '<button style="" id="'+player.id+'status" type="button" class="changeStatus" ><img src="/static/assets/jogador-de-baseball-color.svg" height="30"></button>'+
                                            '</div>'+
                                            '<div>'+
                                                '<h6 class="playerName">'+player.name+'</h6>'+
                                            '</div>'+
                                        '</div>'+
                                    '</div>'+
                                    '<div class="col-1 colorBox " data-toggle="tooltip" data-placement="top" title="Atualize as Kills">'+
                                        '<input type="text" class="input-kills text-center" id="'+player.id+'" value="'+kill+'" name="'+player.jogo_ativo+'" >'+
                                    '</div>'+
                                    '<div class="col-2 ">'+
                                        '<div class="imgXp flex">'+
                                        '<div><img src="/static/assets/kill.svg" height="90"></div>'+
                                        '<div class="kill"><p>kills</p></div>'+
                                         '</div>'+
                                    '</div>'+
                                '</div>'+
                            '</div>'+
                     '</li>';
         }

  sortList('view');

          $(".input-kills").on("input", function(){
        // Print entered value in a div box
         var id = parseInt($(this).attr('id'));
         var kills = Number($(this).val());
         var jogo_ativo = $(this).attr('name');
         data = ({
         id:id,
         kills:kills,
         jogo_ativo:jogo_ativo,
         display:idsquad
         })
         socket.emit('receber kills', data);
    });

    $(".input-inputBox").on("input", function(){
        // Print entered value in a div box
         var jogo_ativo = $(this).attr('data');
         var rank = Number($(this).val());
         var idsquadW = $(this).attr('name');

         data = ({
         idsquadW:idsquadW,
         rank:rank,
         jogo_ativo:jogo_ativo,
         display: idsquad
         })
         socket.emit('receber rank', data);


    });

    $(".encerrar").on("click", function(){
        // Print entered value in a div box
         var idsquadW = $(this).attr('data');
         var jogo_ativo  = $(this).attr('name');

       data = ({
         idsquadW:idsquadW,
         jogo_ativo:jogo_ativo,
         display:idsquad
         })
         socket.emit('receber stage', data);


    });
    $(".changeStatus").on("click", function(){
        $(this).removeClass('changeStatus')
        $(this).addClass("vivo");
        var id = $(this).attr('id')
        addRemoveClass($(this))
        var PlayerArray = playerSelect.listPlayer(id);
        console.log(PlayerArray)


         socket.emit('receber player', PlayerArray);

    });



}









function sortList(ul) {
  var ul = document.getElementById(ul);
  Array.from(ul.getElementsByTagName("LI"))
    .sort((a, b) => +b.dataset.percentage - +a.dataset.percentage)
    .forEach(li => ul.appendChild(li));


}





$(".endBox").on("click", function(){
        // Print entered value in a div box

         var idc  = $(this).attr('data-id');
         var stage = $(this).attr('data-status');

         var ul = document.getElementById('view');
         var st = ul.querySelectorAll('li')[0];
         var st2 = ul.querySelectorAll('li')[1];

         var ganhador = st.dataset.idsquad
         var idGanhador = st.dataset.idpartidas_online
         var g1 = st.dataset.posicao
         var segundo = st2.dataset.idsquad
         var idSegundo = st2.dataset.idpartidas_online
         var g2 = st2.dataset.posicao

         var grupo = g1+g2;
         data = {
         idcampeonato: idc,
         grupo: grupo,
         ganhador: idGanhador,
         segundo: idSegundo,
         status: stage
         }
         //var idsquad = partidaBracket.listCart({{listaSquad|tojson}})
         socket.emit('update',  partidaBracket.listCart({{listaSquad|tojson}}));
         socket.emit('encerrar partida', data);

    });
        socket.on('kills update', function(data){

    playerSelect.setCountForItemKILL(data['id'],data['kills'], data['jogo_ativo'] );
     displayCart(data['display'] );
    })


      socket.on('rank update', function(data){
    partidaBracket.setCountForItemRank(data['idsquadW'], data['rank'],data['jogo_ativo'])
    partidaBracket.totalCart(data['idsquadW']);
     displayCart(data['display'] );
    })

     socket.on('stage update', function(data){
  partidaBracket.SetNextStage(data['idsquadW'],data['jogo_ativo']);
  playerSelect.SetNextStagePlayer(data['idsquadW'],data['jogo_ativo']);
     displayCart(data['display'] );
    })

   socket.on('done', function(data){
      setTimeout(function () {
     window.location.href = "/campeonatoSetup/{{nomeCampeonato}}/{{idcampeonato}}"; //will redirect to bracketList
}, 3000); //will call the function after 2 secs.
    })


    function addRemoveClass(btn) {
    var delay = 15000; // milliseconds
    setTimeout(function() {
        btn.toggleClass('vivo');

        btn.addClass('changeStatus')
    }, delay);

};

</script>
</html>